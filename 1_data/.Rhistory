setwd("C:/Users/User/Desktop/MA/MA/1_data")
# set up
library("ggplot2")
library("lme4")
library("dplyr")
library("ordinal")
# read in data
all.dat <- read.csv("full_dataset_raw.csv", sep=";", header=TRUE)
# put all filler items in a separate data set
fillerDat <- all.dat[all.dat$trial_type == "Filler",]
# rename column in filler dataset to varying acceptability of filler stimuli (A-E)
colnames(fillerDat)[colnames(fillerDat) == "fragmentType_Acceptability"] = "acceptability"
# only use critical items for analysis
dat <- all.dat[all.dat$trial_type == "Critical",]
# rename column with fragment type
colnames(dat)[colnames(dat) == "fragmentType_Acceptability"] = "fragment_type"
# write out abbreviations
dat <- dat %>%
mutate(fragment_type = recode(fragment_type, "L" = "lexical", "F" = "functional"))
nrow(dat) == nrow(fillerDat)
# TRUE
# emphasis
sumStatsEmp <- summarySE(dat, measurevar ="response", groupvars = "emphasis")
?summarySE
library("emmeans")
# emphasis
sumStatsEmp <- summarySE(dat, measurevar ="response", groupvars = "emphasis")
library("rmisc")
library("Rmisc")
# emphasis
sumStatsEmp <- summarySE(dat, measurevar ="response", groupvars = "emphasis")
sumStatsEmp %>%
ggplot(aes(x = emphasis, y = as.numeric(response), color = emphasis)) +
geom_point() +
labs(y="percevied naturalness")+
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16),
plot.title = element_text(size = 20))+
guides(color = guide_legend(override.aes = list(size = 10))) +
geom_errorbar(aes(ymin = as.numeric(response)-ci,
ymax = as.numeric(response)+ci), width = 0.1)+
ylim(1,7)
# all factors included
sumStats <- summarySE(dat, measurevar ="response",
groupvars = c("emphasis", "modality", "fragment_type"))
sumStats$ci <- sumStatsMod$ci
# modality
sumStatsMod <- summarySE(dat, measurevar ="response", groupvars = "modality")
sumStats$ci <- sumStatsMod$ci
#choosing one of the ci columns to ensure consistency when specifying ymin and ymax
sumStats %>%
ggplot(aes(x= fragment_type, y = as.numeric(response))) +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16),
plot.title = element_text(size = 20))+
guides(color = guide_legend(override.aes = list(size = 10))) +
geom_point() +
labs(y="percevied naturalness", x="fragment type") +
scale_x_discrete(labels=c("functional", "lexical")) +
scale_color_discrete(name = "fragment type",
labels = c("functional", "lexical")) +
theme(axis.text=element_text(size=16),
axis.title=element_text(size=16),
plot.title = element_text(size = 20))+
guides(color = guide_legend(override.aes = list(size = 10))) +
geom_errorbar(aes(ymin = as.numeric(response) - ci,
ymax = as.numeric(response) + ci), width = 0.1) +
ylim(1,7) +
facet_grid(emphasis ~ modality)
# z-score the responses
responses_z <- scale(as.numeric(dat$response))
dat$responses_z <- responses_z
mosaicplot(dat$response ~ dat$emphasis, xlab = "perceived naturalness", ylab = "emphasis", color = TRUE)
mosaicplot(dat$response ~ dat$emphasis, xlab = "perceived naturalness", ylab = "emphasis", color = TRUE)
emp.clmm = clmm(as.factor(response) ~ emphasis + (1|submission_id) + (1|trial_number), data = dat)
summary(emp.clmm)
AIC(emp.clmm)
mosaicplot(dat$response ~ dat$modality, xlab = "perceived naturalness", ylab = "modality", color = TRUE)
mod.clmm = clmm(as.factor(response) ~ modality + (1|submission_id) + (1|trial_number), data = dat)
summary(mod.clmm)
AIC(mod.clmm)
mosaicplot(dat$response ~ dat$emphasis, xlab = "perceived naturalness", ylab = "emphasis", color = TRUE)
emp.clmm = clmm(as.factor(response) ~ emphasis + (1|submission_id) + (1|trial_number), data = dat)
summary(emp.clmm)
mosaicplot(dat$response ~ dat$modality, xlab = "perceived naturalness", ylab = "modality", color = TRUE)
mod.clmm = clmm(as.factor(response) ~ modality + (1|submission_id) + (1|trial_number), data = dat)
summary(mod.clmm)
# p value = 0.0158
# We judge there to be evidence in favor of the second hypothesis, if the p-value is less than 0,05.
AIC(mod.clmm)
# p value = 0.0268
# We judge there to be evidence in favor of the first hypothesis, if the p-value is less than 0,05.
AIC(emp.clmm)
# Third hypothesis
# H0: There is no significant difference between stimuli with lexical and functional fragments.
# H1: Stimuli with lexical fragments receive higher acceptability ratings than stimuli with functional fragments
# tested by linear mixed model
# as by this method:
mosaicplot(dat$response ~ dat$fragment_type, xlab = "perceived naturalness", ylab = "fragment type", color = TRUE)
frag.clmm = clmm(as.factor(response) ~ fragment_type + (1|submission_id) + (1|trial_number), data = dat)
summary(frag.clmm)
# p-value = 9.6e-05
# We judge there to be evidence in favor of the third hypothesis, if the p-value is less than 0,05.
AIC(frag.clmm)
# model with all predictors
all.clmm = clmm(as.factor(response) ~ emphasis + modality + fragment_type + (1|submission_id) + (1|trial_number), data = dat)
summary(all.clmm)
# p-value = 9.02e-05
AIC(all.clmm)
# Model fit: Likelihood Ratio Test (compared to null model)
null_model = clmm(as.factor(response) ~ 1 + (1|submission_id), data = dat)
summary(null_model)
AIC(null_model)
anova(null_model, all.clmm) # testet, ob der Unterschied signifikant ist
summary(null_model)
# p-value = 2.445e-07
# yes, it is significant
AIC(all.clmm)-AIC(null_model)
