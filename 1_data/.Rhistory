setwd("C:/Users/User/Desktop/MA/MA/1_data")
# code for data analysis of study on fragments
# set up
library("ggplot2")
library("Rmisc")
library("lme4")
library("dplyr")
library("ordinal")
library("ggmosaic")
library("patchwork")
# read in data
all.dat <- read.csv("full_dataset_raw.csv", sep=";", header=TRUE)
# information about participants
# total number of participants
nrow(all.dat) /56 #divided by 56 because every participants had 56 trials
# 100
# age
min(all.dat$age, na.rm=T)
# 19
max(all.dat$age, na.rm=T)
# 73
mean(all.dat$age, na.rm=T)
# 35.52525
# gender
table(all.dat$gender)/56 #divided by 56 because every participants had 56 trials
# divers  mÃ¤nnlich  weiblich
# 2       69         29
# education
table(all.dat$education) /56 #divided by 56 because every participants had 56 trials
#H\xf6herer Abschluss     Abitur             Bachelor
#35                       29                 27
#kein Abitur
#9
# number of participants in each between-subject condition, i.e., written and auditory
table(all.dat$modality)  /56
# auditory  written
# 57         43
nrow(all.dat)
# 5600
# participants' comments on study
all.dat %>% pull(comments) %>% unique()
# -------------------- Data sorting and cleaning --------------------
# put all filler items in a separate data set
fillerDat <- all.dat[all.dat$trial_type == "Filler",]
# rename column in filler dataset to varying acceptability of filler stimuli (A-E)
colnames(fillerDat)[colnames(fillerDat) == "fragmentType_Acceptability"] = "acceptability"
# only use critical items for analysis
dat <- all.dat[all.dat$trial_type == "Critical",]
# rename column with fragment type
colnames(dat)[colnames(dat) == "fragmentType_Acceptability"] = "fragment_type"
# write out abbreviations
dat <- dat %>%
mutate(fragment_type = recode(fragment_type, "L" = "lexical", "F" = "functional"))
nrow(dat) == nrow(fillerDat)
# TRUE
# z-score the responses
responses_z <- scale(as.numeric(dat$response))
dat$responses_z <- responses_z
# Third hypothesis
# H0: There is no significant difference between stimuli with lexical and functional fragments.
# H1: Stimuli with lexical fragments receive higher acceptability ratings than stimuli with functional fragments
# tested by linear mixed model
# as by this method:
frag.clmm = clmm(as.factor(response) ~ fragment_type + (1|submission_id) + (1|trial_number), data = dat)
summary(frag.clmm)
# We judge there to be evidence in favor of the third hypothesis, if the p-value is less than 0,05.
# p-value = 9.6e-05
AIC(frag.clmm)
# 2843
# Second hypothesis
# H0: There is no significant difference between auditory and written stimuli.
# H1: Auditory stimuli receive higher acceptability ratings than written stimuli.
# tested by linear mixed model
# as by this method:
mod.clmm = clmm(as.factor(response) ~ modality + (1|submission_id) + (1|trial_number), data = dat)
summary(mod.clmm)
# We judge there to be evidence in favor of the second hypothesis, if the p-value is less than 0,05.
# p-value = 0.0158
AIC(mod.clmm)
# 2852
# model with only the submission_id as predictor
null_model = clmm(as.factor(response) ~ 1 + (1|submission_id), data = dat)
summary(null_model)
AIC(null_model)
# testing whether the difference is significant
anova(null_model, all.clmm)
# model with all predictors
all.clmm = clmm(as.factor(response) ~ emphasis + modality + fragment_type + (1|submission_id) + (1|trial_number), data = dat)
summary(all.clmm)
# p-value = 9.02e-05
AIC(all.clmm)
